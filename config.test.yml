# Test Configuration for Multi-Alpha System Integration Testing
# Week 3: IBS A & IBS B Testing

# ============================================================================
# Databento Configuration
# ============================================================================
databento:
  api_key: ${DATABENTO_API_KEY}
  dataset: GLBX.MDP3
  schema: trades
  stype_in: product_id

# ============================================================================
# Data Hub Configuration
# ============================================================================
data_hub:
  redis_host: localhost
  redis_port: 6379
  publish_channels:
    - market
  heartbeat_file: /var/run/pine/data_hub_heartbeat.json
  heartbeat_interval: 30

# ============================================================================
# Instrument Configurations (all instruments for IBS A & IBS B)
# ============================================================================
instruments:
  # IBS A Instruments
  6A:
    size: 1
    commission: 4.0
    multiplier: 100000
    margin: 2000
    databento_product_id: 6A.FUT
    tradovate_symbol: 6A

  6C:
    size: 1
    commission: 4.0
    multiplier: 100000
    margin: 2000
    databento_product_id: 6C.FUT
    tradovate_symbol: 6C

  6M:
    size: 1
    commission: 4.0
    multiplier: 500000
    margin: 2000
    databento_product_id: 6M.FUT
    tradovate_symbol: 6M

  CL:
    size: 1
    commission: 4.0
    multiplier: 1000
    margin: 5000
    databento_product_id: CL.FUT
    tradovate_symbol: CL

  GC:
    size: 1
    commission: 4.0
    multiplier: 100
    margin: 8000
    databento_product_id: GC.FUT
    tradovate_symbol: GC

  HG:
    size: 1
    commission: 4.0
    multiplier: 25000
    margin: 4000
    databento_product_id: HG.FUT
    tradovate_symbol: HG

  # IBS B Instruments
  6B:
    size: 1
    commission: 4.0
    multiplier: 62500
    margin: 2000
    databento_product_id: 6B.FUT
    tradovate_symbol: 6B

  6N:
    size: 1
    commission: 4.0
    multiplier: 100000
    margin: 2000
    databento_product_id: 6N.FUT
    tradovate_symbol: 6N

  6S:
    size: 1
    commission: 4.0
    multiplier: 125000
    margin: 2000
    databento_product_id: 6S.FUT
    tradovate_symbol: 6S

  SI:
    size: 1
    commission: 4.0
    multiplier: 5000
    margin: 6000
    databento_product_id: SI.FUT
    tradovate_symbol: SI

  YM:
    size: 1
    commission: 4.0
    multiplier: 5
    margin: 4000
    databento_product_id: YM.FUT
    tradovate_symbol: YM

# ============================================================================
# Strategy Configurations (IBS A & IBS B for Week 3 testing)
# ============================================================================
strategies:
  # IBS A - Currency & Commodity Focus
  # Optimization: 2025-11-08, Test Sharpe: 7.19, CAGR: 60.5%
  ibs_a:
    enabled: true
    broker_account: ""  # Empty = paper trading (no orders sent)
    starting_cash: 150000
    models_path: src/models/
    max_positions: 2  # Optimized via greedy search
    daily_stop_loss: 2500
    max_bars_in_trade: 100

    # OPTIMIZED: 6 instruments from greedy search (2025-11-08)
    # See: config/portfolio_optimization_ibs_a.json
    instruments:
      - 6A  # AUD - Selected
      - 6C  # CAD - Selected
      - 6M  # MXN - Selected
      - CL  # Crude Oil - Selected
      - GC  # Gold - Selected
      - HG  # Copper - Selected

    # IBS-specific parameters
    strategy_params:
      # Entry thresholds
      ibs_entry_high: 0.7
      ibs_entry_low: 0.3

      # Exit thresholds
      ibs_exit_high: 0.3
      ibs_exit_low: 0.7

      # ML filtering
      use_ml_filter: true
      ml_threshold: 0.65  # Fallback only - actual thresholds per instrument

  # IBS B - Multi-Asset Focus
  # Optimization: 2025-11-08, Test Sharpe: 12.09, CAGR: 91.3%
  ibs_b:
    enabled: true
    broker_account: ""  # Empty = paper trading (no orders sent)
    starting_cash: 150000
    models_path: src/models/
    max_positions: 3  # Optimized via greedy search
    daily_stop_loss: 2500
    max_bars_in_trade: 100

    # OPTIMIZED: 5 instruments from greedy search (2025-11-08)
    # See: config/portfolio_optimization_ibs_b.json
    instruments:
      - 6B  # GBP - Selected
      - 6N  # NZD - Selected
      - 6S  # CHF - Selected
      - SI  # Silver - Selected
      - YM  # Dow - Selected

    # IBS-specific parameters
    strategy_params:
      # Entry thresholds
      ibs_entry_high: 0.7
      ibs_entry_low: 0.3

      # Exit thresholds
      ibs_exit_high: 0.3
      ibs_exit_low: 0.7

      # ML filtering
      use_ml_filter: true
      ml_threshold: 0.65  # Fallback only - actual thresholds per instrument

# ============================================================================
# Dashboard Configuration
# ============================================================================
dashboard:
  port: 5000
  strategies:
    - ibs_a
    - ibs_b
